Device qdot
{
  meshfile = box_in_cube.msh 
  mesh_units = 1e-9
  dimension = 3

  y-growth-direction = (-1,0,1,0)
  x-growth-direction = (-1,2,-1,0)   
  z-growth-direction = (0,0,0,1)

  Region ball
  {
    material = GaN  

    Doping {
      Nd = 1e15
      type = donor
      Ed = 0.025
    }

  }

  Region  qbox
  {
    material = AlN  
 
    Doping {
      Nd = 1e15
      type = donor
      Ed = 0.025
    }
    
  }


  Region  intrinsic
  {
    material =  AlN  
   
    Doping {
      Nd = 1e16
      type =  donor
      Ed = 0.025
    }
    
  }

  Region  nside
  {
    material =  AlN 
   
    Doping {
      Nd = 1e18
      type =  donor
      Ed = 0.025
    }
    
  }


  Region  pside
  {
    material =  AlN  
   
    Doping {
      Nd = 1e18
      type =  donor
      Ed = 0.025
    }
    
  }


  Cluster atomistic
  {
    regions=(ball, qbox)
  }


  Atomistic tb1
  {
    regions = atomistic 
    reference_region = nside  # barrier1 
    #path = tb1.gen
    passivation = yes
    #preserve = conventional
  }

}




Module empirical_tb
{
  regions = atomistic 
  name = tb

  atomistic_structure = tb1
  potential_simulation = dd

  plot = (tbstates)

  Solver
  {
    #relativistic =  true

    num_valence_eigenvalues = 2 #4 #2  #1
    guess_valence = 0.0
    num_conduction_eigenvalues = 2 # 0  # 1
    guess_conduction = 2.5
  }

}




Module macrostrain
{
  name = str
  substrate = cathode

  plot = (Polarization, Ec, Ev, eQFermi, hQFermi, ElField, eDensity, hDensity, ElPotential)

  number_shape_steps = 1  #  for  atom displacement  calculation
  strain_atomistic_structure = tb1  # tb1 = atomistic_structure

  Solver
  {
   lin_rel_tol = 1e-6

   #xmonitor =  true
  }


  Physics
  {
    Boundary cathode
    {
      type = substrate
      material = AlN  # GaN

      y-growth-direction = (-1,0,1,0)
      x-growth-direction = (-1,2,-1,0)   
      z-growth-direction = (0,0,0,1)
    }
  }
} 


Module  driftdiffusion
{ 

  name = dd

  plot = (Strain, PiezoPolarization)
 
  Solver
  {
    #nonlinear_solver = tiber
    #linear_solver = pardiso
   
    max_iterations = 25
    relative_tolerance = 1e-12
 
    step_tolerance = 1e-5
  
    #max_step = 4
  }
 

  Physics
  {
    strain_simulation = str

    particle_density
    {
      statistics = fermidirac
    }


    recombination srh {}

    recombination direct
    { 
     C = 1.1e-8
    }
  
    polarization (piezo, pyro) {}

     
    mobility doping_dependent {}


    Contact anode
    {
      type = ohmic
      voltage = $Vb[0.0]
    }

    Contact cathode
    {
      type = ohmic
      voltage = 0.0
    }
  }
}



Simulation
{
  temperature = 300

  solve = (str, dd, tb)

  resultpath = output 
  output_format = vtk 
}
