Device
{
  meshfile = well.msh 
  mesh_units = 1e-10
  dimension = 1

  x-growth-direction = (0, 0, 1)
  y-growth-direction = (0, 1, 0)
  z-growth-direction = (1, 0, 0)


	Region QW
	{
	material = InAs
	}

	Region barrier_left
	{
	material =  GaAs
	}

	Region barrier_right
	{
	material =  GaAs
	}

	Region device_left
	{
	material = GaAs
	}

	Region device_right
	{
	material = GaAs
	}

	# group together the regions for the quantum simulation
	Cluster Quantum
	{
	regions = (barrier_left, barrier_right, QW)
	}



	Atomistic tb
	{
	  reference_region = barrier_left
	  regions = Quantum
	  passivation = yes
	  print = (xyb, xyz, gen, tgn)
	}

}


Module driftdiffusion
{ 

  name = driftdiffusion
  coupling = poisson

  #save_state = true
  load_state = dd.tsv

  plot = (Ec, Ev, eQFermi, hQFermi, ElField , eDensity, hDensity, Polarization)

  Solver linesearch
  {
    relative_tolerance = 1e-14  
    absolute_tolerance =  1e-50  
    step_tolerance = 1e-3
    max_step = 1.0 
    max_iterations = 30
  }

  Physics
  {
    particle_density
    {
      statistics = fermidirac
    }
  }   

  Contact anode
  {
    type = ohmic
    voltage = 0.0
  }
      
      
  Contact cathode
  {
    type = ohmic
    voltage = $Vb[0.0]  
  }
} 


 
Module empirical_tb
{
  regions = Quantum
  name = tb
  atomistic_structure = tb
  Harrison_scaling = false

  plot = (tbstates)

  Solver
  {
    num_valence_eigenvalues = 4
    num_conduction_eigenvalues = 4
    potential_simulation = driftdiffusion
    relativistic = true
  }

}


Module efaschroedinger
{
  name = kp_electrons
  regions = (barrier_left, barrier_right, QW)
  particle = el
  spectrum_shift = -0.2

  plot = (EigenFunctions, EigenEnergy,EnergyLevels)

  Solver
  {
    x-periodicity = false
    Dirichlet_bc_everywhere = true   # if  false -&gt;  Neumann everywhere
    number_of_eigenstates = 4 
    poisson_model_name = driftdiffusion  #  potential from driftdiffusion
    log_output= false
  }

  Physics
  {
    model = kp
    kp_model = 8x8
  }
}

Module efaschroedinger
{
  simulation_name = kp_holes
  physical_regions = (barrier_left, barrier_right, QW)
  particle = hl
  spectrum_shift = -0.4

  log_output= false

  plot = (EigenFunctions, EigenEnergy,EnergyLevels)

  poisson_model_name = driftdiffusion  #  potential from driftdiffusion
 
  #Solver
  #{
    x-periodicity = false
    Dirichlet_bc_everywhere = true   # if  false -&gt;  Neumann everywhere
    number_of_eigenstates = 4 
  #}

  Physics
  {
    model = kp
    kp_model = 8x8
  }
}




Simulation
{
  temperature = 1
  #solve = (driftdiffusion, kp_electrons, kp_holes,  tb)
  solve = (driftdiffusion, tb)
  resultpath =  output
  output_format = grace

}
