Device
{
  meshfile = quantum_well.msh
  mesh_units = 1e-9
  dimension = 1

#  y-growth-direction = (1,0,-1,0)
#  z-growth-direction = (-1,2,-1,0)
#  x-growth-direction = (0,0,0,1)

  Region well
  {
    mesh_regions = 1
    material = GaN


   
    Doping {

      Nd = 1e18
      type = acceptor
      Ed = 0.025
    }
  }

  Region  buffer
  {
    mesh_regions = 2
    material = AlGaN
    x = 0.3


   
   Doping {

    Nd = 5e16
    type = acceptor
    Ed = 0.025
   }
    
   
  }
  
  

  Region  buffer
  {
    mesh_regions = 3
    material = AlGaN
    x = 0.3
   
   
   Doping {

    Nd = 5e16
    type = acceptor
    Ed = 0.025
   }
    
   
  }


  

}

Module elasticity
{
 plot = (Strain,Stress,Displacement)
 #do_deformation = true
 #shape_iterations = 1

 Physics
 {
   body_force lattice_mismatch
   {
    reference_material = AlGaN
    x = 0.3
    y-growth-direction = (1,0,-1,0)
    z-growth-direction = (-1,2,-1,0)
    x-growth-direction = (0,0,0,1)
   }
 }

 Contact substrate
 { 
   type = clamp
   regions = 1
 }

}


Module macrostrain
{

  name = str

  plot = (Strain, PiezoPolarization)

  #substrate = substrate

  Boundary substrate
  {
    regions = 1
    type = substrate
    material = AlGaN
    x = 0.3
    structure = wz
    y-growth-direction = (1,0,-1,0)
    z-growth-direction = (-1,2,-1,0)
    x-growth-direction = (0,0,0,1)
  }

} 


Module  driftdiffusion
{ 
  name = dd

  plot = (Polarization, Ec, Ev, ElField , eDensity, hDensity)
      
  coupling = poisson
  integration_order = 2

  Solver
  {
    max_iterations = 70
    relative_tolerance = 1e-10
    absolute_tolerance = 1e-10
    step_tolerance = 1e-9
    max_step = 40
    #ls_type = none
    #pc_type = composite
    ksp_type = bcgs
  }


  Physics
  {

    strain_simulation = elasticity # str

    particle_density
    { 
      statistics = boltzmann
    }


    recombination srh {}

    polarization (piezo, pyro) {}
  
    mobility doping_dependent {}

  }

  Contact cathode
  {
    regions = 1
    #zero_grad_fermi_e = true
    type = ohmic
  }


  Contact anode
  {
    regions = 2
    #zero_grad_fermi_e = true
    type = ohmic
    voltage = $Vb 
  }
}

 


Module efaschroedinger
{
  name = quantum_el

  particle = el
  poisson_model_name = dd
  strain_model_name = elasticity


  plot = (EigenFunctions, EigenEnergy, EnergyLevels)

  Solver
  {
    number_of_eigenstates = 10
    #estimate_spectrum_shift = false
    #solve_ev_problem_twice = true	
    #spectrum_shift = 2.0	
    	
    # solver = krylovshur
    # solver = lapack
  }	


  Physics
  {
    #model = conduction_band

    model = kp   #  k.p  for  valence  band
    kp_model = 8x8
  }

}


Module efaschroedinger
{
  name = quantum_hl
  particle = hl
  poisson_model_name = dd
  strain_model_name = elasticity

  plot = (EigenFunctions, EigenEnergy, EnergyLevels)

  Solver
  {
    number_of_eigenstates = 30
    #estimate_spectrum_shift = false
    #solve_ev_problem_twice = true	
    #spectrum_shift = 0.0	
    	
    # solver = krylovshur
    # solver = lapack
  }	

  Physics
  {
    model = kp   #  k.p  for  valence  band
    kp_model = 8x8
  }

  Dispersion
  {
    k-path = K-G-M
    k_max = 0.1
    number_of_nodes = 10	
  }	

}
  

#Module quantumdispersion
#{
#  name = dispersion_el

#  quantum_simulation = quantum_el
#  plot = (k-space_dispersion)

#  wedge = half
#  k_space_dimension = 1
#  k1 = (0, 0.1, 0)
#  number_of_nodes = (10)

  #min_eigenvalue_number = 0
  #max_eigenvalue_number = 9
  
#}


#Module quantumdispersion
#{
#  name = dispersion_hl
#  plot = (k-space_dispersion)

#  quantum_simulation = quantum_hl

#  wedge = half
#  k_space_dimension = 1
#  k1 = (0, 0.1, 0)
#  number_of_nodes = (10)

  #min_eigenvalue_number = 0
  #max_eigenvalue_number = 9
  
#}
    



Simulation
{  
  temperature = 300
  verbose = 1
  #solve = (elasticity, dd, quantum_el, quantum_hl, dispersion_el, dispersion_hl)  
  solve = (elasticity, dd, quantum_el, quantum_hl)  
  #solve = (elasticity, dd, quantum_hl)  

  resultpath = output
  output_format = grace
}
