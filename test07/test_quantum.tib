Device
{

  meshfile = quantum_well.msh
  mesh_units = 1e-9
  dimension = 1


  Region well
  {
    mesh_regions = 1
    material = GaAs

    Doping {
      Nd = 1e15
      type = donor
      Ed = 0.025
    }

  }

  Region  buffer
  {
    mesh_regions = (2, 3)
    material = AlGaAs
    x = 0.3

    Doping {
      Nd = 1e17
      type = donor
      Ed = 0.025
    }
  }
  

  Region  buffer
  {
    mesh_regions = (4, 5)
    material = AlGaAs
    x = 0.3

    Doping {
      Nd = 1e17
      type = donor
      Ed = 0.025
    }
  }

}





#Module macrostrain
#{

#  name = str
#  plot = (Strain, Stress)
#  substrate = substrate

    
#  Boundary substrate 
#  {
#    regions = 1
#    type = substrate
#    material = GaAs
#  }
#}


Module elasticity
{

  name = str
  plot = (Strain, Stress)

  Physics
  {
    body_force lattice_mismatch
    {
      reference_material = GaAs
    }

  }
    
  Boundary clamp
  {
    regions = 1
  }
    
}




Module driftdiffusion
{ 

  name = dd
  plot = (Polarization, Ec, Ev, eQFermi, hQFermi, ElField , eDensity, hDensity, CurrentDensity, NetRecombination)

  coupling = poisson
  integration_order = 2
       
  Solver
  {
    max_iterations = 70
    relative_tolerance = 1e-10
    absolute_tolerance = 1e-10
    step_tolerance = 1e-9
    max_step = 4
    ksp_type = bcgs
  }


    
  Physics
  {
    strain_simulation = str

    #use_density_predictor = true

    recombination srh { }

    
    particle_density
    {
      particle = electron
      statistics = fermidirac

      quantum_density = quantum_el
      barrier_regions = buffer
    }
  
     
    mobility doping_dependent { }

  }

  Boundary cathode
  {
    regions = 1
    #zero_grad_fermi_e = true
    type = ohmic
  }


  Boundary anode
  {
    regions = 2
    #zero_grad_fermi_e = true
    type = ohmic
    voltage = $Vb[0.0]  
  }
 

}


 


Module efaschroedinger
{
  name = quantum_el
  regions = (1, 4, 5)

  particle = el
  
  poisson_model_name = dd
  strain_model_name = macrostrain


  quadrature_rule = trapez

  Solver
  {
    number_of_eigenstates = 5 
    #solver = lapack
  }

  plot = (ProbabilityDensity, EigenEnergy, QuantumDensity)

  Physics
  {
    model = conduction_band    
  }
}


Module efaschroedinger
{
  name = quantum_hl
  regions = all

  particle = hl
  poisson_model_name = dd
  strain_model_name = macrostrain
  
  Solver
  {
     number_of_eigenstates = 10
     solver = arnoldi
  }

  plot = (EigenFunctions, EigenEnergy, EnergyLevels)
  
  Physics
  {
    model = kp   #  k.p  for  valence  band
    kp_model = 6x6
  }
}
  



Module sweep
{
  variable = $Vb
  start = 0.0
  stop =  0.3  #3.5 # 1.0
  steps = 10  # 70 # 20
}

Module selfconsistent
{
  solve = (quantum_el, dd)
  #relaxation_factor = 0.1
  max_iterations = 100
  absolute_tolerance = 5e-4
  relative_tolerance = 1e-9
  monitor = true
}



Simulation
{
  temperature = 300
  solve = (str, dd, quantum_el, selfconsistent)
  #solve = (str, dd, quantum_el)
  resultpath = output
  output_format = grace
}
