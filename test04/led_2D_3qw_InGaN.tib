
#
# y-growth-direction !!!!
#

Device
{

  meshfile =  mesh_led_tri_msh.grd
  mesh_units = 1e-6      

  material = GaN

  structure = wz
  z-growth-direction = (1,0,-1,0)
  x-growth-direction = (-1,2,-1,0)
  y-growth-direction = (0,0,0,-1)


   Region region_1  #pGaN_pcontact
   {

     Doping
     {
       Nd = 3e19
       type = acceptor 
       Ed = 0.170
     }
   }




   Region region_2   #  AlGaN
   {

     material = AlGaN
     x=0.2

     Doping
     {
       Nd = 3e19
       type = acceptor 
       Ed = 0.170
     }

   }



   Region region_3   # GaN_barr_intrinsic
   {
     Doping
     {
       Nd = 1e15
       type = donor 
       Ed = 0.025
     }
   }



   Region InGaN_QW
   {
     mesh_regions =   (3,8,16)           #(3,8,13)

     material = InGaN
     x = 0.14

     Doping
     {
       Nd = 1e15
       type = donor 
       Ed = 0.025
     }

   }



   Region GaN_Barrier
   {
     mesh_regions = (1,4,5,11,13,15,17)        #(1,4,5)

     Doping
     {
       Nd = 3e18
       type = donor 
       Ed = 0.025
     }

   }



#   Region AlInN_OX  # OX
#   {
#   #  reg_numb = 2 
#     #structure = wz
#     #y-growth-direction = (1,0,-1,0)
#     #z-growth-direction = (-1,2,-1,0)
#     #x-growth-direction = (0,0,0,1)
#     mat = SiO2     
#   }

   Region Ex_AlInN_OX  # OX
   {
     mesh_regions = 2 

     Doping
     {
       Nd = 3e18
       type = donor 
       Ed = 0.025
     }
   }




   Region AlInN  #AlInN
   {
     Doping
     {
       Nd = 3e18
       type = donor 
       Ed = 0.025
     }
   }


   Region region_10_lump_2 #GaN_ncontact
   {
     Doping
     {
       Nd = 3e18
       type = donor 
       Ed = 0.025
     }
   }


   Region region_0 #AIR
   {
     mat = Air 
   }

 
}


# Definition of  Simulation Models  and associated Boundary Conditions 
 Module driftdiffusion
  { 

     name = driftdiffusion
     plot = (Ec, Ev, eQFermi, hQFermi, ElField , eDensity, hDensity, eCurrentDensity, hCurrentDensity, ContactCurrent, NetRecombination, eMobility, hMobility, eConductivity, hConductivity, Polarization)

     regions = (1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17)

   Solver linesearch
   {
    max_iterations = 50
    step_tolerance = 1e-4
    max_step =  2 

    linear_solver
    {
      preconditioner = lu
      method = pconly
    }
   }


    Physics
    {
      strain_simulation = strain
      relax_polarization = $polariz[0.0]


      particle_density
      {
        statistics = fermidirac
      }


      recombination srh {}

      recombination direct
      {
        C =  0.47e-10  
      }

      polarization (piezo, pyro) {}
  
    }   


    Contact p_contact
    {
      regions = 21
      type = ohmic
      zero_grad_fermi_e = true
      voltage = $Vb[0.0] 
    }
      
      
    Contact n_contact
    {
      regions = 20
      type = ohmic
      zero_grad_fermi_h = true
      voltage = 0.0
    }
 
} 


Module elasticity
{
   plot = (Strain, Stress, Displacement)
   regions = (1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17)


   name = strain
   Physics
   {
     body_force lattice_mismatch
    {

       reference_material = GaN
       structure = wz
       z-growth-direction = (1,0,-1,0)
       x-growth-direction = (-1,2,-1,0)   
       y-growth-direction = (0,0,0,-1)
    }

   }  


   Contact substr
   {
    type = clamp
    regions = 19
   }


}

#Module macrostrain
#{
#      name = strain
#      plot = (Strain, PiezoPolarization)
#      regions = (1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17)

#  substrate = substr

#  Solver
#  {
#    relative_tolerance = 1e-6 # 1e-8 ok senza  oxide
    #ksp_type = cg #gmres
#    max_iterations = 15000
#    preconditioner = composite
#  }



#  Contact substr
#  {
#    regions = 19
#    type = substrate
#    material = GaN
#    structure = wz
#    z-growth-direction = (1,0,-1,0)
#    x-growth-direction = (-1,2,-1,0)
#    y-growth-direction = (0,0,0,-1)
#  }
 
#}


Module sweep
{
    name = sweep_1
    solve = sweep_2 # driftdiffusion
    variable = $Vb
    start = 0
    stop = 4  #5
    steps =  50 # 25
    plot_data = true
}

Module sweep 
{
    name = sweep_2
     solve = driftdiffusion #sweep_1
     variable = $polariz
     values = (0, 0.2, 0.4, 0.6, 0.7, 0.8, 0.85, 0.9, 0.95, 1.0)
    # start = 0
    # stop = 1
    # steps =  10 #20 # 5
  #   plotvariable = current

}







Simulation
{

  temperature = 300
  solve = (strain, sweep_1)


  #symmetry = cylindrical
  resultpath =  output
  output_format = vtk
}





